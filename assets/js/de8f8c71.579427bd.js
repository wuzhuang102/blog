"use strict";(self.webpackChunkwz_blog=self.webpackChunkwz_blog||[]).push([[5461],{9613:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return d}});var r=n(9496);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var o=r.createContext({}),s=function(e){var t=r.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=s(e.components);return r.createElement(o.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,c=e.originalType,o=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),f=s(n),d=a,k=f["".concat(o,".").concat(d)]||f[d]||u[d]||c;return n?r.createElement(k,l(l({ref:t},p),{},{components:n})):r.createElement(k,l({ref:t},p))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var c=n.length,l=new Array(c);l[0]=f;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var s=2;s<c;s++)l[s]=n[s];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},7254:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return o},default:function(){return d},frontMatter:function(){return i},metadata:function(){return s},toc:function(){return u}});var r=n(2182),a=n(9028),c=(n(9496),n(9613)),l=["components"],i={},o="\u6e90\u7801\u7bc7 --- Vue3 \u6e90\u7801\u89e3\u6790",s={unversionedId:"javascript/framework/vue3",id:"javascript/framework/vue3",title:"\u6e90\u7801\u7bc7 --- Vue3 \u6e90\u7801\u89e3\u6790",description:"\u8001\u89c4\u77e9\uff0c\u901a\u8fc7\u6d4b\u8bd5\u6587\u4ef6\u6765\u53cd\u63a8 Vue3 \u7684\u529f\u80fd",source:"@site/packages/docs/javascript/framework/vue3.md",sourceDirName:"javascript/framework",slug:"/javascript/framework/vue3",permalink:"/blog/docs/javascript/framework/vue3",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"\u6e90\u7801\u7bc7 --- Vue2 \u6e90\u7801\u89e3\u6790",permalink:"/blog/docs/javascript/framework/vue2"},next:{title:"\u6e90\u7801\u7bc7 --- React \u6e90\u7801\u89e3\u6790",permalink:"/blog/docs/javascript/framework/react"}},p={},u=[{value:"\u5199\u5728\u524d\u9762",id:"\u5199\u5728\u524d\u9762",level:2},{value:"\u6574\u4f53\u6d41\u7a0b",id:"\u6574\u4f53\u6d41\u7a0b",level:2},{value:"\u76ee\u5f55\u7ed3\u6784",id:"\u76ee\u5f55\u7ed3\u6784",level:2},{value:"Reactivity",id:"reactivity",level:2},{value:"1. reactive.ts",id:"1-reactivets",level:3},{value:"2. effect.ts",id:"2-effectts",level:3},{value:"3. baseHandlers.ts",id:"3-basehandlersts",level:3},{value:"4. ref.ts",id:"4-refts",level:3},{value:"\u5c0f\u7ed3",id:"\u5c0f\u7ed3",level:3},{value:"runtime-core",id:"runtime-core",level:2},{value:"1. vnode.ts",id:"1-vnodets",level:3}],f={toc:u};function d(e){var t=e.components,i=(0,a.Z)(e,l);return(0,c.kt)("wrapper",(0,r.Z)({},f,i,{components:t,mdxType:"MDXLayout"}),(0,c.kt)("h1",{id:"\u6e90\u7801\u7bc7-----vue3-\u6e90\u7801\u89e3\u6790"},"\u6e90\u7801\u7bc7 --- Vue3 \u6e90\u7801\u89e3\u6790"),(0,c.kt)("p",null,"\u8001\u89c4\u77e9\uff0c\u901a\u8fc7\u6d4b\u8bd5\u6587\u4ef6\u6765\u53cd\u63a8 Vue3 \u7684\u529f\u80fd"),(0,c.kt)("h2",{id:"\u5199\u5728\u524d\u9762"},"\u5199\u5728\u524d\u9762"),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},(0,c.kt)("a",{parentName:"li",href:"https://vue-next-template-explorer.netlify.app/"},"Vue3 \u5728\u7ebf\u7f16\u8bd1\u5668")),(0,c.kt)("li",{parentName:"ul"},"\u6e90\u7801\u7684\u76f8\u5173\u8bf4\u660e\u90fd\u5199\u5728\u6e90\u7801\u91cc\u9762\u4e86\uff0c\u8be6\u60c5\u8bf7\u6233 ",(0,c.kt)("a",{parentName:"li",href:"https://github.com/wuzhuang102/blog/tree/source-code/vue-next"},"vue3 \u6e90\u7801\u6ce8\u91ca"))),(0,c.kt)("h2",{id:"\u6574\u4f53\u6d41\u7a0b"},"\u6574\u4f53\u6d41\u7a0b"),(0,c.kt)("p",null,(0,c.kt)("img",{src:n(6426).Z,width:"3584",height:"2000"})),(0,c.kt)("h2",{id:"\u76ee\u5f55\u7ed3\u6784"},"\u76ee\u5f55\u7ed3\u6784"),(0,c.kt)("p",null,"\u6838\u5fc3\u4ee3\u7801\u90fd\u5728 ",(0,c.kt)("inlineCode",{parentName:"p"},"packages")," \u4e2d\uff0c\u901a\u8fc7 ",(0,c.kt)("a",{parentName:"p",href:"https://github.com/lerna/lerna"},"lerna")," \u8fdb\u884c\u591a\u5305\u7ba1\u7406"),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre"},"\u251c\u2500\u2500 compiler-core           # \u7f16\u8bd1\u5668 AST\n\u251c\u2500\u2500 compiler-dom            # AST ==> render \u51fd\u6570\n\u251c\u2500\u2500 compiler-sfc            # \u89e3\u6790 .vue \u6587\u4ef6\n\u251c\u2500\u2500 compiler-ssr            # \u670d\u52a1\u5668\u6e32\u67d3\u5904\u7406\n\u251c\u2500\u2500 global.d.ts\n\u251c\u2500\u2500 reactivity              # \u6570\u636e\u54cd\u5e94\u7cfb\u7edf proxy\n\u251c\u2500\u2500 runtime-core            # \u4e0e\u5e73\u53f0\u65e0\u5173\u7684\u8fd0\u884c\u65f6\n\u251c\u2500\u2500 runtime-dom             # \u4e0e\u7aef\u63a5\u89e6\u65f6\u7684\u8fd0\u884c\u65f6\n\u251c\u2500\u2500 runtime-test\n\u251c\u2500\u2500 server-renderer\n\u251c\u2500\u2500 shared\n\u251c\u2500\u2500 size-check\n\u251c\u2500\u2500 template-explorer       # \u6a21\u7248\u5728\u7ebf\u7f16\u8bd1\u4ee3\u7801\n\u2514\u2500\u2500 vue\n")),(0,c.kt)("h2",{id:"reactivity"},"Reactivity"),(0,c.kt)("p",null,"reactivity \u9879\u76ee\u76ee\u5f55\u7ed3\u6784"),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre"},"\u251c\u2500\u2500 __tests__\n\u2502   \u251c\u2500\u2500 collections\n\u2502   \u251c\u2500\u2500 computed.spec.ts\n\u2502   \u251c\u2500\u2500 effect.spec.ts\n\u2502   \u251c\u2500\u2500 reactive.spec.ts\n\u2502   \u251c\u2500\u2500 reactiveArray.spec.ts\n\u2502   \u251c\u2500\u2500 readonly.spec.ts\n\u2502   \u251c\u2500\u2500 ref.spec.ts\n\u2502   \u2514\u2500\u2500 shallowReactive.spec.ts\n\u251c\u2500\u2500 index.js\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 baseHandlers.ts\n    \u251c\u2500\u2500 collectionHandlers.ts\n    \u251c\u2500\u2500 computed.ts\n    \u251c\u2500\u2500 effect.ts\n    \u251c\u2500\u2500 index.ts\n    \u251c\u2500\u2500 operations.ts\n    \u251c\u2500\u2500 reactive.ts\n    \u2514\u2500\u2500 ref.ts\n")),(0,c.kt)("h3",{id:"1-reactivets"},"1. reactive.ts"),(0,c.kt)("p",null,"\u76f8\u5173\u7684\u6587\u4ef6\u4e0e\u6d4b\u8bd5\u6587\u4ef6\n",(0,c.kt)("a",{parentName:"p",href:"https://github.com/wuzhuang102/blog/blob/source-code/vue-next/packages/reactivity/src/reactive.ts"},"reactive.ts"),"\n",(0,c.kt)("a",{parentName:"p",href:"https://github.com/wuzhuang102/blog/blob/source-code/vue-next/packages/reactivity/__tests__/reactive.spec.ts"},"reactive.spec.ts")),(0,c.kt)("p",null,"\u672c\u5e93\u7684\u6838\u5fc3\u65b9\u6cd5\uff0c\u4f20\u9012\u4e00\u4e2a object \u7c7b\u578b\u7684\u539f\u59cb\u6570\u636e\uff0c\u901a\u8fc7 Proxy\uff0c\u8fd4\u56de\u4e00\u4e2a\u4ee3\u7406\u6570\u636e\u3002\u5728\u8fd9\u8fc7\u7a0b\u4e2d\uff0c\u52ab\u6301\u4e86\u539f\u59cb\u6570\u636e\u7684\u4efb\u4f55\u8bfb\u5199\u64cd\u4f5c\u3002\u8fdb\u800c\u5b9e\u73b0\u6539\u53d8\u4ee3\u7406\u6570\u636e\u65f6\uff0c\u80fd\u89e6\u53d1\u4f9d\u8d56\u5176\u7684\u76d1\u542c\u51fd\u6570 effect\u3002"),(0,c.kt)("h3",{id:"2-effectts"},"2. effect.ts"),(0,c.kt)("p",null,"\u76f8\u5173\u7684\u6587\u4ef6\u4e0e\u6d4b\u8bd5\u6587\u4ef6\n",(0,c.kt)("a",{parentName:"p",href:"https://github.com/wuzhuang102/blog/blob/source-code/vue-next/packages/reactivity/src/effect.ts"},"effect.ts"),"\n",(0,c.kt)("a",{parentName:"p",href:"https://github.com/wuzhuang102/blog/blob/source-code/vue-next/packages/reactivity/__tests__/effect.spec.ts"},"effect.spec.ts")),(0,c.kt)("p",null,"effect\uff1a\u63a5\u53d7\u4e00\u4e2a\u51fd\u6570\uff0c\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684\u76d1\u542c\u51fd\u6570 reactiveEffect \u3002\u82e5\u76d1\u542c\u51fd\u6570\u5185\u90e8\u4f9d\u8d56\u4e86 reactive \u6570\u636e\uff0c\u5f53\u8fd9\u4e9b\u6570\u636e\u53d8\u66f4\u65f6\u4f1a\u89e6\u53d1\u76d1\u542c\u51fd\u6570\u3002"),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},(0,c.kt)("strong",{parentName:"li"},"\u7ed1\u5b9a\u9636\u6bb5"),(0,c.kt)("ul",{parentName:"li"},(0,c.kt)("li",{parentName:"ul"},"effect \u51fd\u6570\u4f1a\u5305\u542b\u4f20\u5165\u7684\u65b9\u6cd5\u53d8\u6210\u4e00\u4e2a effect \u5bf9\u8c61\uff0c\u5e76\u5728\u7ed1\u5b9a\u9636\u6bb5\u7684\u6700\u540e\u6267\u884c\u4e00\u904d\u4f20\u5165\u7684\u65b9\u6cd5\uff08\u521d\u59cb\u5316\uff09"))),(0,c.kt)("li",{parentName:"ul"},(0,c.kt)("strong",{parentName:"li"},"\u6536\u96c6\u9636\u6bb5"),(0,c.kt)("ul",{parentName:"li"},(0,c.kt)("li",{parentName:"ul"},"effect \u4f20\u5165\u7684\u65b9\u6cd5\u5185\u90e8\uff0c\u6709 reactive \u5bf9\u8c61\u53c2\u4e0e\u8ba1\u7b97\uff0c\u5c06\u89e6\u53d1 get \u64cd\u4f5c\uff0c\u4f1a\u6267\u884c ",(0,c.kt)("inlineCode",{parentName:"li"},"track")," \u65b9\u6cd5"),(0,c.kt)("li",{parentName:"ul"},"track \u65b9\u6cd5\u7684\u91cd\u70b9\u662f\u5c06 reactive \u5bf9\u8c61\u6539\u53d8\u7684 target \u4e0e\u7ed1\u5b9a\u9636\u6bb5\u7684 effect \u5bf9\u8c61\u4e00\u4e00\u5bf9\u5e94\u8d77\u6765\uff0c\u8fd9\u4e24\u4e2a\u9636\u6bb5\u662f\u540c\u6b65\u6267\u884c\u7684\uff08activeReactiveEffectStack \u534f\u8c03\uff09\uff0c\u503c\u4f1a\u5b58\u5728\u5168\u5c40\u7684 targetMap"))),(0,c.kt)("li",{parentName:"ul"},(0,c.kt)("strong",{parentName:"li"},"\u89e6\u53d1\u9636\u6bb5"),(0,c.kt)("ul",{parentName:"li"},(0,c.kt)("li",{parentName:"ul"},"\u5f53 reactive \u5bf9\u8c61 set \u65f6\uff0c\u4f1a\u89e6\u53d1 ",(0,c.kt)("inlineCode",{parentName:"li"},"trigger")," \u65b9\u6cd5\uff0c\u5b83\u4f1a\u4ece targetMap \u62ff\u5230 target \u5bf9\u5e94\u7684 effects\uff0c\u5e76\u904d\u5386\u6267\u884c")))),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-ts"},"// \u6536\u96c6\u4f9d\u8d56\uff1a\u5b58\u50a8\u5728 targetMap \u4e2d\uff08\u8ba2\u9605\uff09\nfunction track(target: object, type: OperationTypes, key?: unknown) {}\n\n// reactive \u5bf9\u8c61 set \u65f6\uff0c\u89e6\u53d1 trigger\uff08\u53d1\u5e03\uff09,\u7136\u540e\u6267\u884c effect \u4e2d\u7684 fn\nfunction trigger(target: object, type: OperationTypes, key?: unknown, extraInfo?: DebuggerEventExtraInfo) {}\n\nfunction run(effect: ReactiveEffect, fn: Function, args: unknown[]): unknown {\n  if (!effect.active) {\n    return fn(...args)\n  }\n  if (!effectStack.includes(effect)) {\n    //effectStack\u4e2d\u6ca1\u6709\u5305\u542beffect\u65f6\uff0c\u624d\u8d70\u8fd9\u4e00\u6b65\n    cleanup(effect) //\u5904\u7406\u76d1\u542c\u51fd\u6570\u4e2d\u53ef\u80fd\u6709\u903b\u8f91\u5224\u65ad\uff0c\u5bfc\u81f4\u6709\u7684\u6570\u636e\u4e0d\u9700\u8981\u83b7\u53d6\uff0c\u6240\u4ee5\u53ef\u4ee5\u907f\u514d\u6bcf\u6b21\u66f4\u65b0\n    /**\n     * \u6267\u884ceffect --\x3e \u628aeffect\u653e\u5165\u5230\u6808\u4e2d --\x3e\n     * \u6267\u884cfn\uff0c\u89e6\u53d1get --\x3e \u89e6\u53d1track --\x3e\n     * \u89e6\u53d1effectStack[effectStack.length-1]\uff0c\u6536\u96c6\u4f9d\u8d56 --\x3e\n     * \u6dfb\u52a0dep\uff08[effect]\uff09\u5230effect.deps --\x3e \u6267\u884c\u5b8cfn\uff0ceffectStack\u51fa\u6808\n     */\n    try {\n      effectStack.push(effect)\n      return fn(...args)\n    } finally {\n      effectStack.pop()\n    }\n  }\n}\n")),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-js"},"// \u4e00\u4e9b\u6570\u636e\u7684\u6570\u636e\u7ed3\u6784\n// targetMap -> target -> depsMap { key1 -> dep : [ effect1, effect2, ... ] } }\nproxy\ntargetMap\n{\n    {a:1} :{\n        a:[effect()]\n    }\n}\n\neffect==>\n1.\u9996\u5148\u4f1a\u6267\u884c\u4e00\u6b21\u5bf9\u5e94\u76d1\u542c\u7684\u51fd\u6570\n2.\u4fee\u6539\u5bf9\u5e94\u76d1\u542c\u51fd\u6570\u5185\u4f7f\u7528\u7684\u54cd\u5e94\u5f0f\u6570\u636e\uff0c\u5bf9\u5e94\u7684\u76d1\u542c\u51fd\u6570\u5c31\u4f1a\u91cd\u65b0\u6267\u884c\uff0c\u91cd\u65b0\u6267\u884c\u7684\u8fc7\u7a0b\u5c31\u4f1a\u83b7\u53d6\u5230\u65b0\u7684\u6570\u636e\n\neffect(fn)\n    ==> createReactiveEffect==warpFn==>lazy ==Effect()==> run(effect, fn, args)\n    ==> effectStack(\u7ef4\u62a4\u4e00\u4e2a\u5806\u6808)\n    ==> effectStack.push (Effect)\n    ==> fn()\n    ==> get ==> track(target,get,'key')==> {\n        target:{\n            key:[Effect]\n        }\n    }\n")),(0,c.kt)("h3",{id:"3-basehandlersts"},"3. baseHandlers.ts"),(0,c.kt)("p",null,"\u76f8\u5173\u7684\u6587\u4ef6",(0,c.kt)("a",{parentName:"p",href:"https://github.com/wuzhuang102/blog/blob/source-code/vue-next/packages/reactivity/src/baseHandlers.ts"},"baseHandlers.ts")),(0,c.kt)("p",null,"baseHandlers \u4e2d\u5b9a\u4e49\u4e86 Proxy state \u4e2d\u7684 get \u4e0e set \u65b9\u6cd5"),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-ts"},"// getter \u5904\u7406\nfunction createGetter(isReadonly: boolean) {\n  track(target, OperationTypes.GET, key)\n  return isObject(res)\n    ? isReadonly\n      ? // need to lazy access readonly and reactive here to avoid circular dependency\n        readonly(res)\n      : reactive(res)\n    : res\n}\n\n// setter \u5904\u7406\nfunction set(target: object, key: string | symbol, value: unknown, receiver: object): boolean {\n  if (target === toRaw(receiver)) {\n    // \u5982\u679c\u662f\u539f\u59cb\u6570\u636e\u539f\u578b\u94fe\u4e0a\u81ea\u5df1\u7684\u64cd\u4f5c\uff0c\u5c31\u4e0d\u89e6\u53d1\n    if (__DEV__) {\n      /* ... */\n    } else {\n      // \u5c5e\u6027\u65b0\u589e\uff0c\u89e6\u53d1 ADD \u679a\u4e3e\n      if (!hadKey) {\n        trigger(target, OperationTypes.ADD, key)\n      } else if (hasChanged(value, oldValue)) {\n        // \u5f53\u65b0\u503c\u4e0e\u65e7\u503c\u4e0d\u76f8\u7b49\u65f6\n        // \u5c5e\u6027\u4fee\u6539\uff0c\u89e6\u53d1 SET \u679a\u4e3e\n        trigger(target, OperationTypes.SET, key)\n      }\n    }\n  }\n}\nexport const mutableHandlers: ProxyHandler<object> = {}\nexport const readonlyHandlers: ProxyHandler<any> = {}\n")),(0,c.kt)("h3",{id:"4-refts"},"4. ref.ts"),(0,c.kt)("p",null,"\u76f8\u5173\u7684\u6587\u4ef6\u4e0e\u6d4b\u8bd5\u6587\u4ef6\n",(0,c.kt)("a",{parentName:"p",href:"https://github.com/wuzhuang102/blog/blob/source-code/vue-next/packages/reactivity/src/ref.ts"},"ref.ts"),"\n",(0,c.kt)("a",{parentName:"p",href:"https://github.com/wuzhuang102/blog/blob/source-code/vue-next/packages/reactivity/__tests__/ref.spec.ts"},"ref.spec.ts")),(0,c.kt)("h3",{id:"\u5c0f\u7ed3"},"\u5c0f\u7ed3"),(0,c.kt)("ol",null,(0,c.kt)("li",{parentName:"ol"},"\u539f\u59cb\u6570\u636e origin \u7ecf\u8fc7 reactive \u65b9\u6cd5\u751f\u6210\u54cd\u5e94\u5f0f\u6570\u636e proxy state\uff0c\u62e5\u6709 setter \u548c getter"),(0,c.kt)("li",{parentName:"ol"},"\u51fd\u6570 fn \u7ecf\u8fc7 effect \u65b9\u6cd5\u751f\u6210\u4e00\u4e2a effect \u5bf9\u8c61\uff0c\u7acb\u5373\u6267\u884c fn \u4e00\u6b21\uff0c\u518d\u901a\u8fc7 run \u65b9\u6cd5",(0,c.kt)("ul",{parentName:"li"},(0,c.kt)("li",{parentName:"ul"},"\u89e6\u53d1 proxy state \u7684 getter\uff0c\u901a\u8fc7 track \u65b9\u6cd5\u6536\u96c6 effect \u4f9d\u8d56"),(0,c.kt)("li",{parentName:"ul"},"\u5c06 effect \u5bf9\u8c61\u5b58\u5165 effectStack \u4e2d\uff0c\u4e3a\u4e86\u4f9d\u8d56\u6536\u96c6"))),(0,c.kt)("li",{parentName:"ol"},"proxy state \u6570\u636e\u66f4\u65b0\u65f6\uff0c\u89e6\u53d1\u5bf9\u5e94 key \u7684 setter\uff0c\u540e\u7eed\u5de5\u4f5c\u4ea4\u7ed9 trigger \u65b9\u6cd5",(0,c.kt)("ul",{parentName:"li"},(0,c.kt)("li",{parentName:"ul"},"\u5148\u6267\u884c computedEffects\u3001\u518d\u6267\u884c scheduleRun")))),(0,c.kt)("p",null,(0,c.kt)("img",{src:n(6078).Z,width:"3442",height:"1920"})),(0,c.kt)("h2",{id:"runtime-core"},"runtime-core"),(0,c.kt)("h3",{id:"1-vnodets"},"1. vnode.ts"),(0,c.kt)("p",null,"Vue3 \u9488\u5bf9 vnode \u4e5f\u8fdb\u884c\u4e86\u4f18\u5316"),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-jsx"},"// ---- \u4e00\u6bb5\u666e\u901a\u7684 vue \u4ee3\u7801\n;<div>\n  <p>foo</p>\n  <p>{{ bar }}</p>\n</div>\n\n// ---- vue \u89e3\u6790\u751f\u6210\u7684 vnode\nconst vnode = {\n  tag: 'div',\n  children: [\n    { tag: 'p', children: 'foo' },\n    { tag: 'div', children: [{ tag: 'p', children: ctx.bar }] },\n  ],\n  // v3\u4f1a\u589e\u52a0\u4e00\u4e2a\uff0c\u52a8\u6001\u8282\u70b9\u6dfb\u52a0\u5230dynamicChildren\uff0c\u4e4b\u540ediff\u76f4\u63a5\u5bf9\u6bd4\u8fd9\u91cc\n  // \u8fd9\u6837\u5728 diff \u7684\u65f6\u5019\uff0c\u5c31\u4e0d\u9700\u8fdb\u884c\u6df1\u5c42\u904d\u5386\n  dynamicChildren: [{ tag: 'p', children: ctx.bar }],\n}\n")),(0,c.kt)("br",null),(0,c.kt)("br",null),(0,c.kt)("p",null,(0,c.kt)("strong",{parentName:"p"},"\u535a\u6587\u53c2\u8003")),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},(0,c.kt)("a",{parentName:"li",href:"http://www.mamicode.com/info-detail-2861150.html"},"Vue \u7684\u54cd\u5e94\u7cfb\u7edf"))))}d.isMDXComponent=!0},6078:function(e,t,n){t.Z=n.p+"assets/images/vue3-reactivity-8106287e8fcdd76ff8429a8d0bc49040.png"},6426:function(e,t,n){t.Z=n.p+"assets/images/vue3-structure-6325bdd4364ea623301ab5b320677766.png"}}]);