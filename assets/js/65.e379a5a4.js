(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{316:function(e,r,t){"use strict";t.r(r);var v=t(28),_=Object(v.a)({},(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"源码篇-webpack-三-：原理分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#源码篇-webpack-三-：原理分析"}},[e._v("#")]),e._v(" 源码篇 --- Webpack(三)：原理分析")]),e._v(" "),t("h2",{attrs:{id:"_1-webapck-hmr"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-webapck-hmr"}},[e._v("#")]),e._v(" 1. Webapck HMR")]),e._v(" "),t("h3",{attrs:{id:"_1-相关概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-相关概念"}},[e._v("#")]),e._v(" 1. 相关概念")]),e._v(" "),t("ol",[t("li",[t("strong",[e._v("Webpack Compiler")]),e._v("： JS 编译成 Bundle")]),e._v(" "),t("li",[t("strong",[e._v("Bundle Server")]),e._v("：文件服务器")]),e._v(" "),t("li",[t("strong",[e._v("HMR Server")]),e._v("：将热更新文件输出给 HMR Runtime")]),e._v(" "),t("li",[t("strong",[e._v("HMR Runtime")]),e._v("：会被注入到 bundle.js 中，与 HMR Server 通过 WebScoket 链接，接受文件变化，并更新对应文件")]),e._v(" "),t("li",[t("strong",[e._v("bundle.js")]),e._v("：构建输出的文件")])]),e._v(" "),t("h3",{attrs:{id:"_2-webpack-hmr-整体流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-webpack-hmr-整体流程"}},[e._v("#")]),e._v(" 2. Webpack HMR 整体流程")]),e._v(" "),t("ol",[t("li",[e._v("Webpack Compiler 将对应的文件打包成 bundle.js（包含注入的 HMR Server），发送给 Bundle Server")]),e._v(" "),t("li",[e._v("浏览器访问 Bundle Server 后，会与 Server 建立一个 WebSocket 长链接")]),e._v(" "),t("li",[e._v("Webpack Compiler 重新编译，结果发送给 HMR Server")]),e._v(" "),t("li",[e._v("HMR Server 可以知道有哪些资源、哪些模块发生了变化，通知 HMR Runtime")]),e._v(" "),t("li",[e._v("HMR Runtime 热更新代码\n"),t("ul",[t("li",[t("strong",[e._v("server端")]),e._v(" "),t("ol",[t("li",[e._v("每次编译会生成 hash 值、已改动模块的 json 文件、已改动模块的 js 文件")]),e._v(" "),t("li",[e._v("编译完后通过 socket 向客户端推送当前编译的 hash 值\n"),t("img",{attrs:{src:"/front-end/js/webpack-hmr-socket.jpg",alt:""}})])])]),e._v(" "),t("li",[t("strong",[e._v("client端")]),e._v(" "),t("ol",[t("li",[e._v("客户端接收 WebSocket 推送过来的 hash 值，和上一次的作比对\n"),t("ul",[t("li",[e._v("一致则走缓存")]),e._v(" "),t("li",[e._v("不一致就通过 ajax 和 jsonp 向服务器端获取最新资\n"),t("img",{attrs:{src:"/front-end/js/webpack-hmr.jpg",alt:""}})])])])])])])]),e._v(" "),t("li",[e._v("热更新失败的话就直接刷新浏览器")])]),e._v(" "),t("br"),e._v(" "),t("br"),e._v(" "),t("br"),e._v(" "),t("p",[t("strong",[e._v("博文参考")])]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://juejin.im/entry/6844903509473640462",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://juejin.im/entry/6844903509473640462"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);r.default=_.exports}}]);