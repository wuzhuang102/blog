<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>框架专题 | 你当像鸟飞往你的山</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="icon" href="/avatar.jpg">
    
    <link rel="preload" href="/assets/css/0.styles.2464540b.css" as="style"><link rel="preload" href="/assets/js/app.52282d9c.js" as="script"><link rel="preload" href="/assets/js/2.b2576fa9.js" as="script"><link rel="preload" href="/assets/js/98.cdf8969c.js" as="script"><link rel="prefetch" href="/assets/js/10.0be33358.js"><link rel="prefetch" href="/assets/js/100.716ebdc8.js"><link rel="prefetch" href="/assets/js/101.58e245f4.js"><link rel="prefetch" href="/assets/js/102.6d030de1.js"><link rel="prefetch" href="/assets/js/103.9f505b69.js"><link rel="prefetch" href="/assets/js/104.36a96edc.js"><link rel="prefetch" href="/assets/js/105.12e8a7b4.js"><link rel="prefetch" href="/assets/js/106.0c84fec3.js"><link rel="prefetch" href="/assets/js/107.dd8cc792.js"><link rel="prefetch" href="/assets/js/108.7323b4b2.js"><link rel="prefetch" href="/assets/js/109.96f90cf3.js"><link rel="prefetch" href="/assets/js/11.9a521f7e.js"><link rel="prefetch" href="/assets/js/110.139fc8a3.js"><link rel="prefetch" href="/assets/js/111.72b6e215.js"><link rel="prefetch" href="/assets/js/112.3e4783dd.js"><link rel="prefetch" href="/assets/js/113.cb5580ff.js"><link rel="prefetch" href="/assets/js/114.1fdeaea5.js"><link rel="prefetch" href="/assets/js/115.6030aed1.js"><link rel="prefetch" href="/assets/js/116.16d6c0b6.js"><link rel="prefetch" href="/assets/js/117.111259b4.js"><link rel="prefetch" href="/assets/js/118.62ff8a4a.js"><link rel="prefetch" href="/assets/js/119.cfcc05c7.js"><link rel="prefetch" href="/assets/js/12.f372d0c6.js"><link rel="prefetch" href="/assets/js/120.b5e9efe6.js"><link rel="prefetch" href="/assets/js/121.c06b5975.js"><link rel="prefetch" href="/assets/js/122.2fdcaf63.js"><link rel="prefetch" href="/assets/js/123.67a72bd2.js"><link rel="prefetch" href="/assets/js/124.852cf569.js"><link rel="prefetch" href="/assets/js/125.a504f556.js"><link rel="prefetch" href="/assets/js/126.8debc763.js"><link rel="prefetch" href="/assets/js/127.1f3ac6f8.js"><link rel="prefetch" href="/assets/js/128.c58d7f07.js"><link rel="prefetch" href="/assets/js/129.007dd18d.js"><link rel="prefetch" href="/assets/js/13.8471e0ab.js"><link rel="prefetch" href="/assets/js/130.820639be.js"><link rel="prefetch" href="/assets/js/131.ef9f9a27.js"><link rel="prefetch" href="/assets/js/132.9375a12d.js"><link rel="prefetch" href="/assets/js/133.65b1660f.js"><link rel="prefetch" href="/assets/js/134.68277f88.js"><link rel="prefetch" href="/assets/js/135.3a417fc0.js"><link rel="prefetch" href="/assets/js/136.ad3d0bf5.js"><link rel="prefetch" href="/assets/js/137.98c1cf0c.js"><link rel="prefetch" href="/assets/js/138.0bdf95bb.js"><link rel="prefetch" href="/assets/js/139.ce6661e8.js"><link rel="prefetch" href="/assets/js/14.6b88d35a.js"><link rel="prefetch" href="/assets/js/140.f09d07e2.js"><link rel="prefetch" href="/assets/js/141.083920e3.js"><link rel="prefetch" href="/assets/js/142.80ec6b60.js"><link rel="prefetch" href="/assets/js/143.4f6fd155.js"><link rel="prefetch" href="/assets/js/144.70ebb78b.js"><link rel="prefetch" href="/assets/js/145.87d82f0e.js"><link rel="prefetch" href="/assets/js/146.501a8306.js"><link rel="prefetch" href="/assets/js/147.c7ca19a7.js"><link rel="prefetch" href="/assets/js/148.f11992a1.js"><link rel="prefetch" href="/assets/js/149.90711701.js"><link rel="prefetch" href="/assets/js/15.bbf26fd6.js"><link rel="prefetch" href="/assets/js/150.0fe91c80.js"><link rel="prefetch" href="/assets/js/151.eba738f9.js"><link rel="prefetch" href="/assets/js/152.ed08d6e0.js"><link rel="prefetch" href="/assets/js/153.57e98815.js"><link rel="prefetch" href="/assets/js/154.6ed7b2b2.js"><link rel="prefetch" href="/assets/js/155.c4f48247.js"><link rel="prefetch" href="/assets/js/156.5bbe6c7f.js"><link rel="prefetch" href="/assets/js/157.c6343f69.js"><link rel="prefetch" href="/assets/js/158.58967568.js"><link rel="prefetch" href="/assets/js/159.efda2d6a.js"><link rel="prefetch" href="/assets/js/16.c07ff42a.js"><link rel="prefetch" href="/assets/js/160.ced00468.js"><link rel="prefetch" href="/assets/js/161.f4cccfbe.js"><link rel="prefetch" href="/assets/js/162.9115d694.js"><link rel="prefetch" href="/assets/js/163.bac22cf3.js"><link rel="prefetch" href="/assets/js/164.26c7de09.js"><link rel="prefetch" href="/assets/js/165.4581cbc1.js"><link rel="prefetch" href="/assets/js/166.42062541.js"><link rel="prefetch" href="/assets/js/167.7c752121.js"><link rel="prefetch" href="/assets/js/168.ec10a223.js"><link rel="prefetch" href="/assets/js/169.1e71713e.js"><link rel="prefetch" href="/assets/js/17.6b1aaf25.js"><link rel="prefetch" href="/assets/js/170.8674d04e.js"><link rel="prefetch" href="/assets/js/171.659ddd64.js"><link rel="prefetch" href="/assets/js/172.fc927677.js"><link rel="prefetch" href="/assets/js/173.effa59d0.js"><link rel="prefetch" href="/assets/js/18.6a53e8bd.js"><link rel="prefetch" href="/assets/js/19.070948a0.js"><link rel="prefetch" href="/assets/js/20.4eab5b4b.js"><link rel="prefetch" href="/assets/js/21.875ef651.js"><link rel="prefetch" href="/assets/js/22.3016600a.js"><link rel="prefetch" href="/assets/js/23.2bceca16.js"><link rel="prefetch" href="/assets/js/24.5ca1a949.js"><link rel="prefetch" href="/assets/js/25.7128f5f5.js"><link rel="prefetch" href="/assets/js/26.2bab6302.js"><link rel="prefetch" href="/assets/js/27.63ee87cc.js"><link rel="prefetch" href="/assets/js/28.0f585b16.js"><link rel="prefetch" href="/assets/js/29.9b1a6733.js"><link rel="prefetch" href="/assets/js/3.cf3e2a61.js"><link rel="prefetch" href="/assets/js/30.0d7f9099.js"><link rel="prefetch" href="/assets/js/31.935ab8aa.js"><link rel="prefetch" href="/assets/js/32.a1046d11.js"><link rel="prefetch" href="/assets/js/33.ca4a9ecf.js"><link rel="prefetch" href="/assets/js/34.fffbe11c.js"><link rel="prefetch" href="/assets/js/35.457e82c7.js"><link rel="prefetch" href="/assets/js/36.ef0a87d5.js"><link rel="prefetch" href="/assets/js/37.1cbbc372.js"><link rel="prefetch" href="/assets/js/38.7e33d6f3.js"><link rel="prefetch" href="/assets/js/39.6904d709.js"><link rel="prefetch" href="/assets/js/4.612c2b09.js"><link rel="prefetch" href="/assets/js/40.c6325732.js"><link rel="prefetch" href="/assets/js/41.b56dca91.js"><link rel="prefetch" href="/assets/js/42.b51db9ce.js"><link rel="prefetch" href="/assets/js/43.8a53c7ca.js"><link rel="prefetch" href="/assets/js/44.f495304f.js"><link rel="prefetch" href="/assets/js/45.4ebd10b5.js"><link rel="prefetch" href="/assets/js/46.5f62cc4b.js"><link rel="prefetch" href="/assets/js/47.578287ae.js"><link rel="prefetch" href="/assets/js/48.a70765fd.js"><link rel="prefetch" href="/assets/js/49.9eb21dfb.js"><link rel="prefetch" href="/assets/js/5.c1b1c539.js"><link rel="prefetch" href="/assets/js/50.69028fff.js"><link rel="prefetch" href="/assets/js/51.2231d361.js"><link rel="prefetch" href="/assets/js/52.aee41e86.js"><link rel="prefetch" href="/assets/js/53.869c8d27.js"><link rel="prefetch" href="/assets/js/54.a63e70db.js"><link rel="prefetch" href="/assets/js/55.91e3e20a.js"><link rel="prefetch" href="/assets/js/56.43b2de29.js"><link rel="prefetch" href="/assets/js/57.b64f6ec9.js"><link rel="prefetch" href="/assets/js/58.77d56ca3.js"><link rel="prefetch" href="/assets/js/59.3d69886d.js"><link rel="prefetch" href="/assets/js/6.22dc9a23.js"><link rel="prefetch" href="/assets/js/60.d083cc6a.js"><link rel="prefetch" href="/assets/js/61.6fa3b2c2.js"><link rel="prefetch" href="/assets/js/62.69bb327e.js"><link rel="prefetch" href="/assets/js/63.24b7de60.js"><link rel="prefetch" href="/assets/js/64.1864f6c1.js"><link rel="prefetch" href="/assets/js/65.e379a5a4.js"><link rel="prefetch" href="/assets/js/66.7d214662.js"><link rel="prefetch" href="/assets/js/67.6032cb0e.js"><link rel="prefetch" href="/assets/js/68.8750df23.js"><link rel="prefetch" href="/assets/js/69.e95607f5.js"><link rel="prefetch" href="/assets/js/7.6ba5400f.js"><link rel="prefetch" href="/assets/js/70.cab3055c.js"><link rel="prefetch" href="/assets/js/71.0c74e7b5.js"><link rel="prefetch" href="/assets/js/72.6e65ef8b.js"><link rel="prefetch" href="/assets/js/73.11090e3d.js"><link rel="prefetch" href="/assets/js/74.8e491969.js"><link rel="prefetch" href="/assets/js/75.7a950686.js"><link rel="prefetch" href="/assets/js/76.0a93f202.js"><link rel="prefetch" href="/assets/js/77.d266642a.js"><link rel="prefetch" href="/assets/js/78.5d0939c8.js"><link rel="prefetch" href="/assets/js/79.773a6b91.js"><link rel="prefetch" href="/assets/js/8.59a26cd5.js"><link rel="prefetch" href="/assets/js/80.1f7745ae.js"><link rel="prefetch" href="/assets/js/81.042df0fe.js"><link rel="prefetch" href="/assets/js/82.98d41715.js"><link rel="prefetch" href="/assets/js/83.cd9dc09e.js"><link rel="prefetch" href="/assets/js/84.801d68d1.js"><link rel="prefetch" href="/assets/js/85.f7ba5a83.js"><link rel="prefetch" href="/assets/js/86.0623bd6d.js"><link rel="prefetch" href="/assets/js/87.255eb8d0.js"><link rel="prefetch" href="/assets/js/88.002727e3.js"><link rel="prefetch" href="/assets/js/89.e403f424.js"><link rel="prefetch" href="/assets/js/9.ad368501.js"><link rel="prefetch" href="/assets/js/90.d7922422.js"><link rel="prefetch" href="/assets/js/91.52d787e9.js"><link rel="prefetch" href="/assets/js/92.d82baf83.js"><link rel="prefetch" href="/assets/js/93.067df34d.js"><link rel="prefetch" href="/assets/js/94.4821f9a9.js"><link rel="prefetch" href="/assets/js/95.f21786f2.js"><link rel="prefetch" href="/assets/js/96.d10c4ddd.js"><link rel="prefetch" href="/assets/js/97.14aa246f.js"><link rel="prefetch" href="/assets/js/99.ed247395.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2464540b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">你当像鸟飞往你的山</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/front-end/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/wiki/" class="nav-link">
  我的wiki
</a></div><div class="nav-item"><a href="/tool/" class="nav-link">
  技术扩展
</a></div><div class="nav-item"><a href="/book/" class="nav-link">
  阅读
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/front-end/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/wiki/" class="nav-link">
  我的wiki
</a></div><div class="nav-item"><a href="/tool/" class="nav-link">
  技术扩展
</a></div><div class="nav-item"><a href="/book/" class="nav-link">
  阅读
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>interview相关</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/interview/" class="sidebar-link">前端面试</a></li><li><a href="/interview/question-outline.html" class="sidebar-link">前端知识点</a></li><li><a href="/interview/js-code.html" class="sidebar-link">JS 编码实践</a></li><li><a href="/interview/algorithm-code.html" class="sidebar-link">算法题</a></li><li><a href="/interview/html-css.html" class="sidebar-link">HTML/CSS</a></li><li><a href="/interview/mobile.html" class="sidebar-link">移动端专题</a></li><li><a href="/interview/frame.html" class="active sidebar-link">框架专题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/frame.html#_1-vue-问题汇总" class="sidebar-link">1. Vue 问题汇总</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/frame.html#_1-1-虚拟-dom" class="sidebar-link">1.1 虚拟 DOM</a></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_1-2-vue-dom-diff-算法" class="sidebar-link">1.2 Vue Dom Diff 算法</a></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_1-3-双向数据绑定-v-model" class="sidebar-link">1.3 双向数据绑定/v-model</a></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_1-4-数组监听" class="sidebar-link">1.4 数组监听</a></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_1-5-computed、methods-区别" class="sidebar-link">1.5 computed、methods 区别</a></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_1-6-nexttick-原理" class="sidebar-link">1.6 nextTick 原理</a></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_1-7-keep-alive-原理" class="sidebar-link">1.7 keep-alive 原理</a></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_1-8-依赖收集" class="sidebar-link">1.8 依赖收集</a></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_1-9-父子组件，非父子组件通信方式" class="sidebar-link">1.9 父子组件，非父子组件通信方式</a></li></ul></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_2-vue3-相关" class="sidebar-link">2. Vue3 相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/frame.html#_2-1-vue3-新特性" class="sidebar-link">2.1 Vue3 新特性</a></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_2-2-vue2-与-vue3-响应式对比" class="sidebar-link">2.2 Vue2 与 Vue3 响应式对比</a></li></ul></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_3-vuex-原理" class="sidebar-link">3. Vuex 原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/frame.html#_3-1-vuex-工作流程" class="sidebar-link">3.1 Vuex 工作流程</a></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_3-2-几个重要的概念" class="sidebar-link">3.2 几个重要的概念</a></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_3-3-为什么使用-vuex-redux" class="sidebar-link">3.3 为什么使用 Vuex/Redux</a></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_3-4-vuex-与-redux-的区别" class="sidebar-link">3.4 Vuex 与 Redux 的区别</a></li></ul></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_4-webpack-执行流程" class="sidebar-link">4. Webpack 执行流程</a></li><li class="sidebar-sub-header"><a href="/interview/frame.html#_5-webpack-做过哪些优化" class="sidebar-link">5. Webpack 做过哪些优化</a></li></ul></li><li><a href="/interview/node.html" class="sidebar-link">Node 专题</a></li><li><a href="/interview/network.html" class="sidebar-link">网络/安全 专题</a></li><li><a href="/interview/project.html" class="sidebar-link">项目高光时刻</a></li><li><a href="/interview/design.html" class="sidebar-link">程序设计</a></li><li><a href="/interview/base1.html" class="sidebar-link">JS 基础篇 1</a></li><li><a href="/interview/base2.html" class="sidebar-link">JS 基础篇 2</a></li><li><a href="/interview/base3.html" class="sidebar-link">JS 基础篇 3</a></li><li><a href="/interview/exp-ans.html" class="sidebar-link">面试题总结</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="框架专题"><a href="#框架专题" class="header-anchor">#</a> 框架专题</h1> <h2 id="_1-vue-问题汇总"><a href="#_1-vue-问题汇总" class="header-anchor">#</a> 1. Vue 问题汇总</h2> <h3 id="_1-1-虚拟-dom"><a href="#_1-1-虚拟-dom" class="header-anchor">#</a> 1.1 虚拟 DOM</h3> <ul><li>什么是 Virtual DOM
<ul><li>本质上，虚拟 DOM 是一个 JavaScript 对象，通过对象的方式来表示 DOM 结构，将页面的状态抽象为 JS 对象的形式，配合不同的渲染工具，使跨平台渲染成为可能。</li> <li>通过事物处理机制，将多次 DOM 修改的结果一次性的更新到页面上，从而<strong>有效的减少页面渲染的次数，减少修改 DOM 的重绘重排次数，提高渲染性能</strong>。</li></ul></li> <li>为什么使用 Virtual DOM
<ul><li>保证性能下限，在不进行手动优化的情况下，提供过得去的性能</li> <li>跨平台
<ul><li>虚拟 DOM 本质上是 JS 对象，可以很方便的跨平台操作，比如服务器渲染、uniapp 等</li></ul></li></ul></li> <li>Virtual DOM 的问题
<ul><li>首次渲染大量 DOM 时，由于多了一层虚拟 DOM 的计算，会比 innnerHTML 插入慢</li></ul></li></ul> <h3 id="_1-2-vue-dom-diff-算法"><a href="#_1-2-vue-dom-diff-算法" class="header-anchor">#</a> 1.2 Vue Dom Diff 算法</h3> <ol><li>算法复杂度
<ul><li>两棵树的完全 Dom diff 时间复杂度度在 O(n^3)，但是 Vue 它只进行同层级的 Dom diff，只有 O(n)</li></ul></li> <li>diff 算法的两个特点
<ul><li>只会同级比较，不跨层级</li> <li>diff 比较循环两边往中间靠拢</li></ul></li> <li><a href="/front-end/javascript/source-code/vue.html#_5-patch-js">比较过程</a> <ul><li>新旧 Vnode 进行开始位置和结束位置的标记<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> oldStartIdx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> newStartIdx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> oldEndIdx <span class="token operator">=</span> oldCh<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span>oldEndIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> newEndIdx <span class="token operator">=</span> newCh<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span>newEndIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li> <li>循环处理节点
<ol><li>如果当前 oldStartVnode 和 newStartVnode 节点相同，会复用老节点，进行 patchVnode，更新 oldStartVnode、newStartVnode，odlStartIndex++、newStartIndex++</li> <li>如果当前 oldEndVnode 和 newEndVnode 节点相同，直接复用老节点，进行 patchVnode，更新 oldEndVnode、newEndVnode，oldEndIndex--、newEndIndex--</li> <li>如果当前 oldStartVnode 和 newEndVnode 节点相同，直接复用老节点，进行 patchVnode，将老节点移动到 odlEndVnode 之后，更新 oldStartVnode、newEndVnode，oldStartIndex++、newEndIndex--</li> <li>如果当前 oldEndVnode 和 newStartVnode 节点相同，直接复用老节点，进行 patchVnode，将老节点移动到 oldStartVnode 之前，更新 oldEndVnode、newStartVnode，oldEndIndex--，newStartIndex++</li> <li>如果都不满足相同则没有相同节点复用，进行 key 对比(老节点依据 key 生成一个字典)。满足的进行 patchVnode，就将对应的节点移动到 oldStartVnode 之前，更新 newStartVnode，newStartIndex++</li> <li>循环结束，oldStartIdx &gt; oldEndIdx 的话就清除剩下的老节点， newStartIdx &gt; newEndIdx 的话就直接插入对应的位置</li></ol></li></ul></li></ol> <img src="/interview/vue-dom-diff.png" class="zoom-img"> <h3 id="_1-3-双向数据绑定-v-model"><a href="#_1-3-双向数据绑定-v-model" class="header-anchor">#</a> 1.3 双向数据绑定/v-model</h3> <div class="language-js extra-class"><pre class="language-js"><code>Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_1-4-数组监听"><a href="#_1-4-数组监听" class="header-anchor">#</a> 1.4 数组监听</h3> <p>Vue 通过原型拦截的方式重写了数组的 7 个方法，首先获取到这个数组的 ob （它的 Observer 对象），如果有新值，就调用 observeArray 对新的值进行监听，然后手动调用 notify，通知 render watcher，执行 update</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// https://github.com/vuejs/vue/blob/dev/src/core/observer/array.js</span>
<span class="token keyword">const</span> arrayProto <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> arrayMethods <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>arrayProto<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> methodsToPatch <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;push&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pop&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;shift&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;unshift&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;splice&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sort&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;reverse&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

methodsToPatch<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">method</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> original <span class="token operator">=</span> arrayProto<span class="token punctuation">[</span>method<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">def</span><span class="token punctuation">(</span>arrayMethods<span class="token punctuation">,</span> method<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">mutator</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ..</span>
        ob<span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_1-5-computed、methods-区别"><a href="#_1-5-computed、methods-区别" class="header-anchor">#</a> 1.5 computed、methods 区别</h3> <ul><li>computed 是响应式的， methods 不是</li> <li>computed 定义的成员像属性一样访问，methods 定义的成员必须以函数的方式访问</li> <li>computed 带缓存的</li> <li>computed 可以只定义一个函数作为只读属性，也可以定义 get/set 变成读写属性</li> <li>computed 不支持异步</li></ul> <h3 id="_1-6-nexttick-原理"><a href="#_1-6-nexttick-原理" class="header-anchor">#</a> 1.6 nextTick 原理</h3> <p>由于 Vue 的更新是异步执行的，并且缓存在同一事件循环中，等同一数据循环中的所有数据变化完成后，再统一进行视图更新</p> <p>核心利用了 Promise、MutationObserver、setImmediate、setTimeout 模拟宏/微任务</p> <h3 id="_1-7-keep-alive-原理"><a href="#_1-7-keep-alive-原理" class="header-anchor">#</a> 1.7 keep-alive 原理</h3> <p>本质就是 LRU 算法</p> <ol><li>获取 keep-alive 下第一个子组件的实例对象，然后获取这个组件的组件名</li> <li>通过组件名去匹配 include、exclude，判断是否需要缓存，不需要缓存就直接返回当前组件的实例 vNode</li> <li>需要缓存则更新缓存中对应组件的 LRU 位置，超出长度就删除最远距离的哪个组件</li></ol> <h3 id="_1-8-依赖收集"><a href="#_1-8-依赖收集" class="header-anchor">#</a> 1.8 <a href="/front-end/javascript/source-code/vue.html#依赖收集过程">依赖收集</a></h3> <h3 id="_1-9-父子组件，非父子组件通信方式"><a href="#_1-9-父子组件，非父子组件通信方式" class="header-anchor">#</a> 1.9 父子组件，非父子组件通信方式</h3> <h4 id="_1-父组件向子组件传值"><a href="#_1-父组件向子组件传值" class="header-anchor">#</a> 1. 父组件向子组件传值</h4> <ul><li>Props 传值</li> <li>$parent 获取父组件的方法或属性</li></ul> <h4 id="_2-子组件向父组件传值"><a href="#_2-子组件向父组件传值" class="header-anchor">#</a> 2. 子组件向父组件传值</h4> <ul><li>通过 $emit 触发自定义事件</li> <li>$children 获取子组件实例</li> <li>使用 ref 获取子组件实例</li></ul> <h4 id="_3-兄弟组件传值"><a href="#_3-兄弟组件传值" class="header-anchor">#</a> 3. 兄弟组件传值</h4> <h4 id="_4-跨组件"><a href="#_4-跨组件" class="header-anchor">#</a> 4. 跨组件</h4> <ul><li>$attrs、$listeners</li> <li>project、inject</li> <li>vuex</li></ul> <h2 id="_2-vue3-相关"><a href="#_2-vue3-相关" class="header-anchor">#</a> 2. Vue3 相关</h2> <h3 id="_2-1-vue3-新特性"><a href="#_2-1-vue3-新特性" class="header-anchor">#</a> 2.1 Vue3 新特性</h3> <h4 id="_2-1-1-composition-api"><a href="#_2-1-1-composition-api" class="header-anchor">#</a> 2.1.1 Composition API</h4> <p>组合 API、为了实现基于函数式编程的机制而生</p> <ol><li><strong>声明变量</strong> <ul><li>通过 reactive 声明变量</li></ul></li> <li><strong>生命周期的变更</strong><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> onMounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;component is mounted!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li></ol> <h4 id="_2-1-2-performance-优化"><a href="#_2-1-2-performance-优化" class="header-anchor">#</a> 2.1.2 performance 优化</h4> <ol><li><p><strong>编译模板的静态标记</strong>：重构了虚拟 DOM，保持兼容性，使 DOM 脱离模板渲染，Dom Diff 时提升性能</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>周一呢<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>明天就周二了<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{week}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>vue2 编译结果</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">with</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">_c</span><span class="token punctuation">(</span>
            <span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                attrs<span class="token operator">:</span> <span class="token punctuation">{</span>
                    id<span class="token operator">:</span> <span class="token string">&quot;app&quot;</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">&quot;周一呢&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">&quot;明天就周二了&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token function">_s</span><span class="token punctuation">(</span>week<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>vue3 编译结果，只有 <code>_createVNode</code> 的四个参数不为空时，才会遍历</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createVNode <span class="token keyword">as</span> _createVNode<span class="token punctuation">,</span> toDisplayString <span class="token keyword">as</span> _toDisplayString<span class="token punctuation">,</span> openBlock <span class="token keyword">as</span> _openBlock<span class="token punctuation">,</span> createBlock <span class="token keyword">as</span> _createBlock <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">_ctx<span class="token punctuation">,</span> _cache</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token function">_openBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">_createBlock</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&quot;app&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">_createVNode</span><span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;周一呢&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">_createVNode</span><span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;明天就周二了&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">_createVNode</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token function">_toDisplayString</span><span class="token punctuation">(</span>_ctx<span class="token punctuation">.</span>week<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token comment">/* TEXT */</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p><strong>事件侦听器缓存</strong>
默认条件下事件是动态追踪的，Vue3 中将事件缓存在缓存中</p></li> <li><p><strong>静态提升</strong>
静态节点放在了 render 函数的外部，避免每次 render 都会生成一次静态节点</p></li></ol> <h4 id="_2-1-3-tree-shaking"><a href="#_2-1-3-tree-shaking" class="header-anchor">#</a> 2.1.3 Tree-shaking</h4> <p>打包时自动去除了没有用到的 Vue 模块</p> <h4 id="_2-1-4-更好的-ts-支持"><a href="#_2-1-4-更好的-ts-支持" class="header-anchor">#</a> 2.1.4 更好的 ts 支持</h4> <ul><li>类型定义提示</li> <li>tsx 语法</li> <li>class 组件</li></ul> <h4 id="_2-1-5-全家桶"><a href="#_2-1-5-全家桶" class="header-anchor">#</a> 2.1.5 全家桶</h4> <p>vite 的绑定</p> <h3 id="_2-2-vue2-与-vue3-响应式对比"><a href="#_2-2-vue2-与-vue3-响应式对比" class="header-anchor">#</a> 2.2 Vue2 与 Vue3 响应式对比</h3> <ul><li>Vue2：Object.defineProperty</li> <li>Vue3：Proxy、Reflect</li></ul> <ol><li>Object.defineProperty 只能劫持对象属性，Proxy 代理整个对象</li> <li>Object.defineProperty 对新增对象需要手动 Observe (vm.$set())</li> <li>Proxy 最大问题是兼容，而且 polyfill 也无法抹平</li></ol> <h2 id="_3-vuex-原理"><a href="#_3-vuex-原理" class="header-anchor">#</a> 3. Vuex 原理</h2> <img src="/interview/vuex.png" class="zoom-img"> <h3 id="_3-1-vuex-工作流程"><a href="#_3-1-vuex-工作流程" class="header-anchor">#</a> 3.1 Vuex 工作流程</h3> <ol><li>Vue Components 中会 触发（dispatch）一些事件或动作，也就是 Actions。</li> <li>Acions 中一般是异步操作，操作结果提交（commit）至 Mutations 中，Vuex 中的数据更新操作集中在 Mutations 中。</li> <li>Mutations 接受到就去改变 State 中的值。</li> <li>当 State 中的数据改变之后，对应的 View 就会被更新。</li></ol> <h3 id="_3-2-几个重要的概念"><a href="#_3-2-几个重要的概念" class="header-anchor">#</a> 3.2 几个重要的概念</h3> <ol><li>Vue Components</li> <li>Actions</li> <li>dispatch</li> <li>Mutations</li> <li>commit</li> <li>state</li> <li>getters</li></ol> <h3 id="_3-3-为什么使用-vuex-redux"><a href="#_3-3-为什么使用-vuex-redux" class="header-anchor">#</a> 3.3 为什么使用 Vuex/Redux</h3> <p>传参对于多层嵌套的组件将会非常繁琐，并且对于兄弟组件间的状态传递无能为力，父子组件直接引用或者通过事件来变更状态的模式会变得非常脆弱，且代码不好维护。</p> <p>将组件需要共享的状态抽取出来，以一个全局单例模式管理，这种模式下的组件树构成了一个巨大的视图，不管在树的哪个位置，任何组件都能获取状态或者触发行为。</p> <h3 id="_3-4-vuex-与-redux-的区别"><a href="#_3-4-vuex-与-redux-的区别" class="header-anchor">#</a> 3.4 Vuex 与 Redux 的区别</h3> <ol><li>Vuex 中使用 Mutation 代替了 Redux 中的 Reducer（通过 switch 改变 state 中的值）</li> <li>Vuex 由于 Vue 自动重新渲染的特性，只要生成新的 state 就可以</li></ol> <h2 id="_4-webpack-执行流程"><a href="#_4-webpack-执行流程" class="header-anchor">#</a> 4. Webpack 执行流程</h2> <p>webpack 是基于事件流的，通过一系列的插件来运行，利用 tapable 库提供各种钩子来实现对于整个构建流程各个步骤的控制</p> <ol><li>创建 Compiler 实例，用于控制构建流程，compiler 实例包含 webpack 基本环境信息</li> <li>根据配置项转换成对应内部插件，并初始化 options 配置项</li> <li>执行 compiler.run</li> <li>创建 Compilation 实例，每次构建都会创建一个 Compilation 实例，包含这次构建的基本信息</li> <li>从 entry 开始递归分析依赖，对每个依赖模块进行 buildModule，通过 Loader 将不同类型的模块转换成 Webpack 模块</li> <li>调用 Parser.parse 将上面的结果转换成 AST 树</li> <li>遍历 AST 树，收集依赖 Dependency，并保存在 Compilation 实例的 dependencies 中</li> <li>生成 Chunks，不同 entry 生成不同 chunk，动态导入也会生成自己的 chunk，生成的 chunk 后还会进行优化</li> <li>使用 Template 基于 Compilation 的数据生成结果代码</li></ol> <h2 id="_5-webpack-做过哪些优化"><a href="#_5-webpack-做过哪些优化" class="header-anchor">#</a> 5. Webpack 做过哪些优化</h2> <ul><li><p><strong>优化构建速度</strong></p> <ul><li>多线程构建：<code>thread-loader</code></li> <li>缩小打包作用域
<ul><li>exclude/include</li> <li>resolve.extensions(文件扩展名)、resolve.modules(第三方模块路径)</li> <li>module.noParse：这些文件不解析，但是也会打包进去</li> <li>IgnorePlugin</li></ul></li> <li>缓存
<ul><li><code>babel-loader</code>：开启缓存</li> <li><code>terser-webpack-plugin</code>：开启缓存(webpack5 已内置)</li></ul></li> <li>DLL
<ul><li>DllPlugin 进行分包，使用 DllreferencePlgin 对 mainfest.json 引用， 对基本不变的资源限行打包成静态资源，避免反复编译浪费时间。</li></ul></li></ul></li> <li><p><strong>优化 Webpack 打包体积</strong></p> <ul><li>代码压缩
<ul><li><code>uglifyjs-webpack-plugin</code>：压缩 js</li> <li><code>mini-css-extract-plugin</code>：提取 chunk 中的 css 到单独文件</li> <li><code>optimize-css-assets-webpack-plugin</code>：开启 cssnano 压缩 css</li></ul></li> <li>提取页面公共资源
<ul><li><code>html-webpack-externals-plugin</code>：基础包通过 CDN 引入，不打入 bundle</li> <li><code>split-chunks-plugin</code>：公共资源分离公用(webpack4 以上内置)</li></ul></li> <li>tree-shaking
<ul><li><code>purgecss-webpack-plugin</code>：去除无用 css，建议配合 <code>mini-css-extract-plugin</code> 配合使用</li> <li>webpack 已内置 tree-shaking，基于 ES6 的</li></ul></li> <li>Scope Hoisting
<ul><li><code>webpack.optimize.ModuleConcatenationPlugin()</code>：闭包合并优化</li></ul></li> <li>图片压缩
<ul><li><code>image-webpack-loader</code>：图片压缩</li></ul></li> <li>动态 Polyfill
<ul><li>polyfill-service 只返回给用户需要的 polyfill</li> <li><code>@babel/preset-env</code>：通过 <code>useBuiltlns:'usage'</code>参数动态加载 polyfill</li></ul></li></ul></li> <li><p><strong>打包结果分析</strong></p> <ul><li><code>speed-measure-webpack-plugin</code>：分析打包过程中 Loader 和 Plugin 的耗时，找出构建过程的性能瓶颈</li></ul></li></ul> <div class="language- extra-class"><pre class="language-text"><code>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/interview/mobile.html" class="prev">
        移动端专题
      </a></span> <span class="next"><a href="/interview/node.html">
        Node 专题
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.52282d9c.js" defer></script><script src="/assets/js/2.b2576fa9.js" defer></script><script src="/assets/js/98.cdf8969c.js" defer></script>
  </body>
</html>
